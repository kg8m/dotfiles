# prefix
unbind-key C-b
set -g prefix C-t
bind-key C-t send-prefix

# prefix r to reload ~/.tmux.conf
bind r source-file ~/.tmux.conf \; display-message "Reload .tmux.conf."

# create new window inheriting current path
bind c new-window -c "#{pane_current_path}"

# looks
set -g default-terminal xterm-256color

# http://www.glidenote.com/archives/1767
set -g status-fg white
set -g status-bg colour23
set -g status-attr bold
set -g status-left-length 50
set -g status-right-length 100
set -g status-left ''
set -g status-right "  #[fg=colour250]last saved at #(~/.zsh/tmux/tmux_resurrect_last_saved_at.sh)#[default]"

setw -g automatic-rename off

# window-status-current
setw -g window-status-current-fg colour23
setw -g window-status-current-bg white
setw -g window-status-current-attr bold#,underscore

set -g pane-border-fg colour240
set -g pane-border-bg colour240

# https://hnakamur.github.io/blog/2015/12/29/homebrew-tmux-ambiguous-width-cjk-patch/
set -q -g pane-border-ascii on
# http://qiita.com/yanma/items/2644e6db6f3bcf249690
set -ag terminal-overrides ',*:U8=0'

# pane-active-border
set -g pane-active-border-fg colour23
set -g pane-active-border-bg green

# others
set -g monitor-activity on
set -g window-status-activity-bg yellow
set -g window-status-activity-fg colour23
set -g base-index 1
set -g bell-action none
set -g history-limit 25000
set -g mouse on

# split into panes like Vim
bind h split-window -v -c "#{pane_current_path}"
bind v split-window -h -c "#{pane_current_path}"

bind C-t select-pane -t :.+  # <C-t><C-t> to next pane
bind C-n select-pane -t :.+  # <C-t><C-n> to next pane
bind C-p select-pane -t :.-  # <C-t><C-p> to prev pane

# http://qiita.com/pocari/items/b1828c8aea8e3545cadd
set display-panes-time 10000
bind p display-panes

# copy mode like Vim
setw -g mode-keys vi
bind y copy-mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection
bind P run "tmux save-buffer -"
bind C-c run "tmux save-buffer - | ssh main 'LC_CTYPE=UTF-8 pbcopy'" \; display-message "Copy the Selection by pbcopy."

# http://www.youtube.com/watch?v=xUB-quCdun0
# clear scroll buffer
# use C-l then C-t then C-l
bind C-l clear-history\; display-message "History Cleared."

set -s escape-time 0

# http://qiita.com/ryoppy/items/96a4f1eacbe2fd55f18c
set -g @plugin "tmux-plugins/tpm"
set -g @plugin "tmux-plugins/tmux-resurrect"
set -g @plugin "tmux-plugins/tmux-continuum"
set -g @plugin "nhdaly/tmux-scroll-copy-mode"
set -g @resurrect-save-shell-history "off"
set -g @resurrect-capture-pane-contents "on"
set -g @resurrect-processes "ssh mysql ruby rake irb pry '~rails console' less more head tail top watch git"
set -g @resurrect-strategy-vim "session"
set -g @continuum-restore "on"
set -g @continuum-save-interval "1"
set -g @scroll-speed-num-lines-per-scroll "1"
run-shell "~/.tmux/plugins/tpm/tpm"

if-shell "[ -f ~/.tmux.conf.local ]" "source ~/.tmux.conf.local"
