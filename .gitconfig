[init]
# http://klabgames.tech.blog.jp.klab.com/archives/1033121546.html
templatedir = ~/.git_templates/

[color]
branch = auto
diff   = auto
status = auto

[color "branch"]
current = white red
local   = yellow
remote  = green

[color "diff"]
meta = green
frag = magenta bold
old  = cyan
new  = red

[color "status"]
added     = yellow
changed   = green
untracked = cyan

[color]
ui = true

[core]
whitespace=fix,-indent-with-non-tab,trailing-space,cr-at-eol
editor = vim
excludesfile = ~/.gitignore

[branch]
autosetupmerge = true

[alias]
# base
aliases = !git alias
alias   = !git config --get-regexp '^alias\\.' | sed 's/alias\\.\\([^ ]*\\) \\(.*\\)/\\1\\\t => \\2/' | sort -k3

ignore = !( [ ! -e .gitignore ] && touch .gitignore ) | echo $1 >> .gitignore
find   = !git ls-files | grep --ignore-case
info   = remote show origin
ru     = remote update
sh     = show
st     = status

chmod = "!f() {\
  command=\"git update-index --add --chmod=$@\";\
  echo '# '${command};\
  eval ${command};\
}; f"

# clone
crone                 = !git clone-with-submodules
clone-with-submodules = clone --recursive

# checkout
co = checkout
ch = checkout HEAD

# pull/fetch/merge/rebase
up = !git update
fc = fetch
pl = pull --stat
pr = pull --stat --rebase

update = "!f() {\
  command=\"git pull --stat --rebase || ( git rebase --abort && echo 'rebase aborted!!' )\";\
  echo '# '${command};\
  eval ${command};\
}; f"

# branch
brs      = !git branches
br       = branch
branches = branch -avv

delete-local-fully-merged-branch = branch --delete
delete-local-branch              = branch -D
delete-remote-branch             = push --delete origin

create-branch = "!f() {\
  read -p 'Input commit messages (e.g., #1 create a branch): ' commit_messages;\
  \
  branch_name=$1;\
  original_branch=${2:-origin/master};\
  command=\"git checkout -b ${branch_name} ${original_branch}\";\
  command=${command}\" && git commit --allow-empty --message=' ${commit_messages}'\";\
  command=${command}\" && git push -u origin ${branch_name}\";\
  command=${command}\"; git branches\";\
  \
  echo '# '${command};\
  read -p 'Are you sure? [y/n]: ' response;\
  \
  if [[ ${response} =~ ^y ]]; then\
    eval ${command};\
  else\
    echo 'aborted.';\
  fi;\
}; f"

# add
add-all = !git add . && git add --updaste && git status
ad      = add
at      = add --intent-to-add

# commit
cm = commit --ammend
ci = commit
ca = commit --all

# reset/revert
edit-commits      = "!f() { git rebase --interactive HEAD~$1; }; f"
reset-commits     = !git edit-commits
reset-last-commit = reset --soft HEAD~
undo-add          = reset --soft
rv                = revert

# log
lg    = !git graph
graph = log --graph --pretty=format:\"%Cgreen%h %ci %Cblue%cn %Creset%s\"
lo    = log --stat
lp    = log --stat --patch

# diff
di = diff --ignore-all-space --ignore-blank-lines --ignore-space-at-eol --ignore-space-change
dc = diff --ignore-all-space --ignore-blank-lines --ignore-space-at-eol --ignore-space-change --cached
dw = diff --ignore-all-space --ignore-blank-lines --ignore-space-at-eol --ignore-space-change --color-words
dh = diff --ignore-all-space --ignore-blank-lines --ignore-space-at-eol --ignore-space-change HEAD
da = diff HEAD

compare-branches = diff-branches

diff-branches = "!f() {\
  branches1=($( git branch -r | awk '{print $1}' | peco --prompt 'select first branch:' ));\
  if [[ ! ${#branches1[@]} -eq 1 ]]; then\
    echo 'select only 1 branch.';\
    exit 1;\
  fi;\
  \
  branches2=($( git branch -r | awk '{print $1}' | peco --prompt 'select another branch:' ));\
  if [[ ! ${#branches2[@]} -eq 1 ]]; then\
    echo 'select only 1 branch.';\
    exit 1;\
  fi;\
  \
  command=\"git di ${branches1[0]}...${branches2[0]}\";\
  \
  echo '# '${command};\
  read -p 'Are you sure? [y/n]: ' response;\
  \
  if [[ ${response} =~ ^y ]]; then\
    eval ${command};\
  else\
    echo 'aborted.';\
  fi;\
}; f"

# submodule
su                = !git update-submodules
update-submodules = !git submodule update --init --recursive && git submodule update --remote && git status

# hook
update-hooks = !( rm -i .git/hooks/* || exit 0 ) && cp ~/.git_templates/hooks/* .git/hooks/ && ls -l .git/hooks/

[github]
user = kg8m

[include]
path = ~/.gitconfig.local

[diff]
algorithm = histogram
context = 10
compactionHeuristic = true

[fetch]
prune = true

[user]
name  = kg8m
email = takumi.kagiyama@gmail.com
useConfigOnly = true

[submodule]
fetchJobs = 4

[pager]
log  = diff-highlight | less --LINE-NUMBERS
show = diff-highlight | less --LINE-NUMBERS
diff = diff-highlight | less --LINE-NUMBERS

[interactive]
diffFilter = diff-highlight

[commit]
verbose = true
